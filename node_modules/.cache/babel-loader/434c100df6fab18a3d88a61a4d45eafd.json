{"ast":null,"code":"/**\n * @author mrdoob / http://mrdoob.com/\n */\nimport { Vector3 } from '../math/Vector3.js';\nimport { Quaternion } from '../math/Quaternion.js';\nimport { Clock } from '../core/Clock.js';\nimport { Object3D } from '../core/Object3D.js';\nimport { AudioContext } from './AudioContext.js';\n\nvar _position = new Vector3();\n\nvar _quaternion = new Quaternion();\n\nvar _scale = new Vector3();\n\nvar _orientation = new Vector3();\n\nfunction AudioListener() {\n  Object3D.call(this);\n  this.type = 'AudioListener';\n  this.context = AudioContext.getContext();\n  this.gain = this.context.createGain();\n  this.gain.connect(this.context.destination);\n  this.filter = null;\n  this.timeDelta = 0; // private\n\n  this._clock = new Clock();\n}\n\nAudioListener.prototype = Object.assign(Object.create(Object3D.prototype), {\n  constructor: AudioListener,\n  getInput: function () {\n    return this.gain;\n  },\n  removeFilter: function () {\n    if (this.filter !== null) {\n      this.gain.disconnect(this.filter);\n      this.filter.disconnect(this.context.destination);\n      this.gain.connect(this.context.destination);\n      this.filter = null;\n    }\n\n    return this;\n  },\n  getFilter: function () {\n    return this.filter;\n  },\n  setFilter: function (value) {\n    if (this.filter !== null) {\n      this.gain.disconnect(this.filter);\n      this.filter.disconnect(this.context.destination);\n    } else {\n      this.gain.disconnect(this.context.destination);\n    }\n\n    this.filter = value;\n    this.gain.connect(this.filter);\n    this.filter.connect(this.context.destination);\n    return this;\n  },\n  getMasterVolume: function () {\n    return this.gain.gain.value;\n  },\n  setMasterVolume: function (value) {\n    this.gain.gain.setTargetAtTime(value, this.context.currentTime, 0.01);\n    return this;\n  },\n  updateMatrixWorld: function (force) {\n    Object3D.prototype.updateMatrixWorld.call(this, force);\n    var listener = this.context.listener;\n    var up = this.up;\n    this.timeDelta = this._clock.getDelta();\n    this.matrixWorld.decompose(_position, _quaternion, _scale);\n\n    _orientation.set(0, 0, -1).applyQuaternion(_quaternion);\n\n    if (listener.positionX) {\n      // code path for Chrome (see #14393)\n      var endTime = this.context.currentTime + this.timeDelta;\n      listener.positionX.linearRampToValueAtTime(_position.x, endTime);\n      listener.positionY.linearRampToValueAtTime(_position.y, endTime);\n      listener.positionZ.linearRampToValueAtTime(_position.z, endTime);\n      listener.forwardX.linearRampToValueAtTime(_orientation.x, endTime);\n      listener.forwardY.linearRampToValueAtTime(_orientation.y, endTime);\n      listener.forwardZ.linearRampToValueAtTime(_orientation.z, endTime);\n      listener.upX.linearRampToValueAtTime(up.x, endTime);\n      listener.upY.linearRampToValueAtTime(up.y, endTime);\n      listener.upZ.linearRampToValueAtTime(up.z, endTime);\n    } else {\n      listener.setPosition(_position.x, _position.y, _position.z);\n      listener.setOrientation(_orientation.x, _orientation.y, _orientation.z, up.x, up.y, up.z);\n    }\n  }\n});\nexport { AudioListener };","map":{"version":3,"sources":["H:/chrlab/src/component/panelComponent/Canvas/threejs/src/audio/AudioListener.js"],"names":["Vector3","Quaternion","Clock","Object3D","AudioContext","_position","_quaternion","_scale","_orientation","AudioListener","call","type","context","getContext","gain","createGain","connect","destination","filter","timeDelta","_clock","prototype","Object","assign","create","constructor","getInput","removeFilter","disconnect","getFilter","setFilter","value","getMasterVolume","setMasterVolume","setTargetAtTime","currentTime","updateMatrixWorld","force","listener","up","getDelta","matrixWorld","decompose","set","applyQuaternion","positionX","endTime","linearRampToValueAtTime","x","positionY","y","positionZ","z","forwardX","forwardY","forwardZ","upX","upY","upZ","setPosition","setOrientation"],"mappings":"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","sourcesContent":["/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nimport { Vector3 } from '../math/Vector3.js';\nimport { Quaternion } from '../math/Quaternion.js';\nimport { Clock } from '../core/Clock.js';\nimport { Object3D } from '../core/Object3D.js';\nimport { AudioContext } from './AudioContext.js';\n\nvar _position = new Vector3();\nvar _quaternion = new Quaternion();\nvar _scale = new Vector3();\nvar _orientation = new Vector3();\n\nfunction AudioListener() {\n\n\tObject3D.call( this );\n\n\tthis.type = 'AudioListener';\n\n\tthis.context = AudioContext.getContext();\n\n\tthis.gain = this.context.createGain();\n\tthis.gain.connect( this.context.destination );\n\n\tthis.filter = null;\n\n\tthis.timeDelta = 0;\n\n\t// private\n\n\tthis._clock = new Clock();\n\n}\n\nAudioListener.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\tconstructor: AudioListener,\n\n\tgetInput: function () {\n\n\t\treturn this.gain;\n\n\t},\n\n\tremoveFilter: function ( ) {\n\n\t\tif ( this.filter !== null ) {\n\n\t\t\tthis.gain.disconnect( this.filter );\n\t\t\tthis.filter.disconnect( this.context.destination );\n\t\t\tthis.gain.connect( this.context.destination );\n\t\t\tthis.filter = null;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tgetFilter: function () {\n\n\t\treturn this.filter;\n\n\t},\n\n\tsetFilter: function ( value ) {\n\n\t\tif ( this.filter !== null ) {\n\n\t\t\tthis.gain.disconnect( this.filter );\n\t\t\tthis.filter.disconnect( this.context.destination );\n\n\t\t} else {\n\n\t\t\tthis.gain.disconnect( this.context.destination );\n\n\t\t}\n\n\t\tthis.filter = value;\n\t\tthis.gain.connect( this.filter );\n\t\tthis.filter.connect( this.context.destination );\n\n\t\treturn this;\n\n\t},\n\n\tgetMasterVolume: function () {\n\n\t\treturn this.gain.gain.value;\n\n\t},\n\n\tsetMasterVolume: function ( value ) {\n\n\t\tthis.gain.gain.setTargetAtTime( value, this.context.currentTime, 0.01 );\n\n\t\treturn this;\n\n\t},\n\n\tupdateMatrixWorld: function ( force ) {\n\n\t\tObject3D.prototype.updateMatrixWorld.call( this, force );\n\n\t\tvar listener = this.context.listener;\n\t\tvar up = this.up;\n\n\t\tthis.timeDelta = this._clock.getDelta();\n\n\t\tthis.matrixWorld.decompose( _position, _quaternion, _scale );\n\n\t\t_orientation.set( 0, 0, - 1 ).applyQuaternion( _quaternion );\n\n\t\tif ( listener.positionX ) {\n\n\t\t\t// code path for Chrome (see #14393)\n\n\t\t\tvar endTime = this.context.currentTime + this.timeDelta;\n\n\t\t\tlistener.positionX.linearRampToValueAtTime( _position.x, endTime );\n\t\t\tlistener.positionY.linearRampToValueAtTime( _position.y, endTime );\n\t\t\tlistener.positionZ.linearRampToValueAtTime( _position.z, endTime );\n\t\t\tlistener.forwardX.linearRampToValueAtTime( _orientation.x, endTime );\n\t\t\tlistener.forwardY.linearRampToValueAtTime( _orientation.y, endTime );\n\t\t\tlistener.forwardZ.linearRampToValueAtTime( _orientation.z, endTime );\n\t\t\tlistener.upX.linearRampToValueAtTime( up.x, endTime );\n\t\t\tlistener.upY.linearRampToValueAtTime( up.y, endTime );\n\t\t\tlistener.upZ.linearRampToValueAtTime( up.z, endTime );\n\n\t\t} else {\n\n\t\t\tlistener.setPosition( _position.x, _position.y, _position.z );\n\t\t\tlistener.setOrientation( _orientation.x, _orientation.y, _orientation.z, up.x, up.y, up.z );\n\n\t\t}\n\n\t}\n\n} );\n\nexport { AudioListener };\n"]},"metadata":{},"sourceType":"module"}