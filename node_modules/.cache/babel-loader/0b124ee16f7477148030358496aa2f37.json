{"ast":null,"code":"import * as THREE from 'three';\n\nclass taskReplenish {\n  constructor(agv, con, stock) {\n    this.prop = {\n      id: 't-',\n      agv: agv,\n      product: null,\n      con: con,\n      stock: stock,\n      from: new THREE.Vector3(),\n      mid: new THREE.Vector3(),\n      dest: new THREE.Vector3(),\n      state: 0.0,\n      msg: 'init'\n    };\n    this.init();\n  }\n\n  init() {\n    this.prop.from = this.prop.agv.prop.basecen;\n    this.prop.mid = new THREE.Vector3(this.prop.stock.prop.basecen.x + this.prop.stock.prop.size.x * this.prop.stock.prop.open.x, this.prop.stock.prop.basecen.y, this.prop.stock.prop.basecen.z + this.prop.stock.prop.size.z * this.prop.stock.prop.open.z);\n    this.prop.dest = new THREE.Vector3(this.prop.con.prop.basecen.x + this.prop.con.prop.size.x * this.prop.con.prop.open.x, this.prop.con.prop.basecen.y, this.prop.con.prop.basecen.z + this.prop.con.prop.size.z * this.prop.con.prop.open.z);\n  }\n\n  setTask(agv, con, stock) {\n    this.prop.stock = stock;\n    this.prop.con = con;\n    this.prop.agv = agv; //console.log(this.prop.stock);\n\n    if (this.prop.stock.prop.state > 0) {\n      this.prop.product = this.prop.stock.prop.contain[this.prop.stock.prop.state - 1]; //console.log(this.prop.product);\n    }\n\n    this.init();\n  }\n\n  setId(v) {\n    this.prop.id = v;\n  }\n\n  Progress(t) {\n    // Vector3\n    let ap = this.prop.from;\n    let cp = 1;\n\n    if (t <= 80) {\n      ap = new THREE.Vector3(this.prop.from.x + (this.prop.mid.x - this.prop.from.x) * (t * 0.0125), this.prop.from.y, this.prop.from.z + (this.prop.mid.z - this.prop.from.z) * (t * 0.0125));\n    } else if (t <= 100 && t > 80) {\n      ap = new THREE.Vector3(this.prop.mid.x, this.prop.from.y, this.prop.mid.z);\n      cp = (this.prop.mid.y - this.prop.from.y) * ((t - 80) * 0.05);\n    } else if (t <= 120 && t > 100) {\n      ap = new THREE.Vector3(this.prop.mid.x, this.prop.from.y, this.prop.mid.z);\n      cp = (this.prop.mid.y - this.prop.from.y) * ((120 - t) * 0.05);\n    } else if (t <= 200 && t > 120) {\n      ap = new THREE.Vector3(this.prop.mid.x + (this.prop.con.prop.basecen.x + this.prop.con.prop.size.x * this.prop.con.prop.open.x - this.prop.mid.x) * ((t - 120) * 0.0125), this.prop.from.y, this.prop.mid.z + (this.prop.con.prop.basecen.z + this.prop.con.prop.size.z * this.prop.con.prop.open.z - this.prop.mid.z) * ((t - 120) * 0.0125));\n    } else if (t <= 220 && t > 200) {\n      ap = new THREE.Vector3(this.prop.dest.x, this.prop.from.y, this.prop.dest.z);\n      cp = (this.prop.dest.y - this.prop.from.y) * ((t - 200) * 0.05);\n    } else if (t <= 240 && t > 220) {\n      ap = new THREE.Vector3(this.prop.dest.x, this.prop.from.y, this.prop.dest.z);\n\n      if (t < 240) {\n        cp = (this.prop.dest.y - this.prop.from.y) * ((240 - t) * 0.05);\n      }\n    }\n\n    this.prop.agv.setPosition(ap);\n    this.prop.agv.prop.ra.setHeight(cp);\n    this.prop.state = t / 240.0;\n\n    if (this.prop.state <= 1.0) {\n      if (this.prop.product) {\n        if (t > 220) {\n          this.prop.con.setContain(this.prop.product);\n          this.prop.product.setPosition(this.prop.con.prop.basecen);\n          this.prop.agv.prop.ra.setRemove();\n          this.prop.stock.setRemove(this.prop.product); // product in container\n\n          this.prop.msg = '[' + this.prop.product.prop.id + '] put in [' + this.prop.con.prop.id + ']';\n        } else if (t <= 220 && t > 100) {\n          this.prop.agv.prop.ra.setContain(this.prop.product);\n          this.prop.product.setPosition(this.prop.agv.prop.ra.prop.basecen);\n          this.prop.stock.setRemove(this.prop.product);\n          this.prop.con.setRemove(); // product in container\n\n          this.prop.msg = '[' + this.prop.product.prop.id + '] on AGV (x:' + this.prop.agv.prop.basecen.x.toFixed(2) + ', y:' + this.prop.agv.prop.basecen.z.toFixed(2) + ')';\n        } else {\n          this.prop.stock.addContain(this.prop.product); //this.prop.product.setPosition(this.prop.stock.prop.basecen);\n\n          this.prop.con.setRemove();\n          this.prop.agv.prop.ra.setRemove();\n          this.prop.msg = 'AGV go to [' + this.prop.stock.prop.id + ']';\n        }\n      }\n\n      if (cp > 1) {\n        this.prop.msg += '</br>[' + this.prop.agv.prop.ra.prop.id + '] on height (z:' + cp.toFixed(2) + ')';\n      } else {\n        this.prop.msg += '</br>[' + this.prop.agv.prop.ra.prop.id + '] standby...';\n      }\n    }\n  }\n\n  getMsg() {\n    return \"[\" + this.prop.id + \"]</br>\" + this.prop.msg;\n  }\n\n}\n\nexport default taskReplenish;","map":{"version":3,"sources":["D:/chrlab/src/component/panelComponent/Canvas/StorageStorejs/threejs/taskReplenish.js"],"names":["THREE","taskReplenish","constructor","agv","con","stock","prop","id","product","from","Vector3","mid","dest","state","msg","init","basecen","x","size","open","y","z","setTask","contain","setId","v","Progress","t","ap","cp","setPosition","ra","setHeight","setContain","setRemove","toFixed","addContain","getMsg"],"mappings":"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","sourcesContent":["import * as THREE from 'three';\r\n\r\nclass taskReplenish {\r\n    constructor(agv,con,stock) {\r\n        this.prop ={\r\n            id:'t-',\r\n            agv:agv,\r\n            product:null,\r\n            con:con,\r\n            stock:stock,\r\n            from:new THREE.Vector3(),\r\n            mid:new THREE.Vector3(),\r\n            dest:new THREE.Vector3(),\r\n            state:0.0,\r\n            msg:'init'\r\n        }\r\n       this.init();\r\n     }\r\n    init(){\r\n        this.prop.from = this.prop.agv.prop.basecen;\r\n        this.prop.mid = new THREE.Vector3( this.prop.stock.prop.basecen.x +(this.prop.stock.prop.size.x*this.prop.stock.prop.open.x),\r\n                                            this.prop.stock.prop.basecen.y,\r\n                                            this.prop.stock.prop.basecen.z +(this.prop.stock.prop.size.z*this.prop.stock.prop.open.z));\r\n        this.prop.dest = new THREE.Vector3( this.prop.con.prop.basecen.x +(this.prop.con.prop.size.x*this.prop.con.prop.open.x),\r\n                                            this.prop.con.prop.basecen.y,\r\n                                            this.prop.con.prop.basecen.z +(this.prop.con.prop.size.z*this.prop.con.prop.open.z));\r\n    }\r\n\r\n    setTask(agv,con,stock){\r\n        this.prop.stock = stock;\r\n        this.prop.con = con;\r\n        this.prop.agv = agv;\r\n        //console.log(this.prop.stock);\r\n        if (this.prop.stock.prop.state >0){\r\n            this.prop.product = this.prop.stock.prop.contain[this.prop.stock.prop.state-1];\r\n            //console.log(this.prop.product);\r\n        }\r\n        this.init();\r\n    }\r\n    setId(v){\r\n        this.prop.id=v;\r\n    }\r\n    Progress(t){ // Vector3\r\n        let ap=this.prop.from;\r\n        let cp=1;\r\n\r\n        if (t<=80){\r\n            ap = new THREE.Vector3( this.prop.from.x+(this.prop.mid.x-this.prop.from.x)*(t*0.0125),\r\n                                    this.prop.from.y,\r\n                                    this.prop.from.z+(this.prop.mid.z-this.prop.from.z)*(t*0.0125),\r\n                                    );\r\n        }else if(t<=100 && t>80){\r\n            ap = new THREE.Vector3(this.prop.mid.x,this.prop.from.y,this.prop.mid.z);\r\n            cp = (this.prop.mid.y-this.prop.from.y)*((t-80)*0.05);\r\n        }else if(t<=120 && t>100){\r\n            ap = new THREE.Vector3(this.prop.mid.x,this.prop.from.y,this.prop.mid.z);\r\n            cp = (this.prop.mid.y-this.prop.from.y)*((120-t)*0.05);\r\n        }else if(t<=200 && t>120){\r\n            ap = new THREE.Vector3( this.prop.mid.x+(( this.prop.con.prop.basecen.x +(this.prop.con.prop.size.x*this.prop.con.prop.open.x)\r\n                                                        -this.prop.mid.x)*((t-120)*0.0125)),\r\n                                    this.prop.from.y,\r\n                                    this.prop.mid.z+(( this.prop.con.prop.basecen.z +(this.prop.con.prop.size.z*this.prop.con.prop.open.z)\r\n                                                        -this.prop.mid.z)*((t-120)*0.0125))\r\n                                    );\r\n        }else if(t<=220 && t>200){\r\n            ap = new THREE.Vector3(this.prop.dest.x,this.prop.from.y,this.prop.dest.z);\r\n            cp = (this.prop.dest.y-this.prop.from.y)*((t-200)*0.05);\r\n        }else if(t<=240 && t>220){\r\n            ap = new THREE.Vector3(this.prop.dest.x,this.prop.from.y,this.prop.dest.z);\r\n            if (t<240){\r\n                cp = (this.prop.dest.y-this.prop.from.y)*((240-t)*0.05);\r\n            }\r\n        }\r\n        this.prop.agv.setPosition(ap);\r\n        this.prop.agv.prop.ra.setHeight(cp);\r\n        this.prop.state = t/240.0;\r\n        if (this.prop.state<=1.0){\r\n            if (this.prop.product){\r\n                if (t>220){\r\n                    this.prop.con.setContain(this.prop.product);\r\n                    this.prop.product.setPosition(this.prop.con.prop.basecen);\r\n                    this.prop.agv.prop.ra.setRemove();\r\n                    this.prop.stock.setRemove(this.prop.product);\r\n                    // product in container\r\n                    this.prop.msg = '[' + this.prop.product.prop.id + '] put in [' + this.prop.con.prop.id + ']';\r\n                }else if (t<=220 && t>100){\r\n                    this.prop.agv.prop.ra.setContain(this.prop.product);\r\n                    this.prop.product.setPosition(this.prop.agv.prop.ra.prop.basecen);\r\n                    this.prop.stock.setRemove(this.prop.product);\r\n                    this.prop.con.setRemove();\r\n                    // product in container\r\n                    this.prop.msg = '[' +this.prop.product.prop.id + '] on AGV (x:' + this.prop.agv.prop.basecen.x.toFixed(2) + ', y:' + this.prop.agv.prop.basecen.z.toFixed(2) + ')';\r\n                }else{\r\n                    this.prop.stock.addContain(this.prop.product);\r\n                    //this.prop.product.setPosition(this.prop.stock.prop.basecen);\r\n                    this.prop.con.setRemove();\r\n                    this.prop.agv.prop.ra.setRemove();\r\n                    this.prop.msg = 'AGV go to [' + this.prop.stock.prop.id + ']';\r\n                }\r\n            }\r\n            if (cp>1){\r\n                this.prop.msg += '</br>['+this.prop.agv.prop.ra.prop.id+'] on height (z:'+cp.toFixed(2)+')';\r\n            }else{\r\n                this.prop.msg += '</br>['+this.prop.agv.prop.ra.prop.id+'] standby...';\r\n            }\r\n        }\r\n    }\r\n    getMsg(){\r\n        return \"[\"+this.prop.id+\"]</br>\"+this.prop.msg;\r\n    }\r\n}\r\nexport default taskReplenish;"]},"metadata":{},"sourceType":"module"}