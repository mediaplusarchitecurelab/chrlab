{"ast":null,"code":"/**\n * @author mrdoob / http://mrdoob.com/\n */\nimport { BackSide, FrontSide, CubeUVReflectionMapping } from '../../constants.js';\nimport { BoxBufferGeometry } from '../../geometries/BoxGeometry.js';\nimport { PlaneBufferGeometry } from '../../geometries/PlaneGeometry.js';\nimport { ShaderMaterial } from '../../materials/ShaderMaterial.js';\nimport { Color } from '../../math/Color.js';\nimport { Mesh } from '../../objects/Mesh.js';\nimport { ShaderLib } from '../shaders/ShaderLib.js';\nimport { cloneUniforms } from '../shaders/UniformsUtils.js';\n\nfunction WebGLBackground(renderer, state, objects, premultipliedAlpha) {\n  var clearColor = new Color(0x000000);\n  var clearAlpha = 0;\n  var planeMesh;\n  var boxMesh;\n  var currentBackground = null;\n  var currentBackgroundVersion = 0;\n  var currentTonemapping = null;\n\n  function render(renderList, scene, camera, forceClear) {\n    var background = scene.background; // Ignore background in AR\n    // TODO: Reconsider this.\n\n    var xr = renderer.xr;\n    var session = xr.getSession && xr.getSession();\n\n    if (session && session.environmentBlendMode === 'additive') {\n      background = null;\n    }\n\n    if (background === null) {\n      setClear(clearColor, clearAlpha);\n    } else if (background && background.isColor) {\n      setClear(background, 1);\n      forceClear = true;\n    }\n\n    if (renderer.autoClear || forceClear) {\n      renderer.clear(renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil);\n    }\n\n    if (background && (background.isCubeTexture || background.isWebGLCubeRenderTarget || background.mapping === CubeUVReflectionMapping)) {\n      if (boxMesh === undefined) {\n        boxMesh = new Mesh(new BoxBufferGeometry(1, 1, 1), new ShaderMaterial({\n          type: 'BackgroundCubeMaterial',\n          uniforms: cloneUniforms(ShaderLib.cube.uniforms),\n          vertexShader: ShaderLib.cube.vertexShader,\n          fragmentShader: ShaderLib.cube.fragmentShader,\n          side: BackSide,\n          depthTest: false,\n          depthWrite: false,\n          fog: false\n        }));\n        boxMesh.geometry.deleteAttribute('normal');\n        boxMesh.geometry.deleteAttribute('uv');\n\n        boxMesh.onBeforeRender = function (renderer, scene, camera) {\n          this.matrixWorld.copyPosition(camera.matrixWorld);\n        }; // enable code injection for non-built-in material\n\n\n        Object.defineProperty(boxMesh.material, 'envMap', {\n          get: function () {\n            return this.uniforms.envMap.value;\n          }\n        });\n        objects.update(boxMesh);\n      }\n\n      var texture = background.isWebGLCubeRenderTarget ? background.texture : background;\n      boxMesh.material.uniforms.envMap.value = texture;\n      boxMesh.material.uniforms.flipEnvMap.value = texture.isCubeTexture ? -1 : 1;\n\n      if (currentBackground !== background || currentBackgroundVersion !== texture.version || currentTonemapping !== renderer.toneMapping) {\n        boxMesh.material.needsUpdate = true;\n        currentBackground = background;\n        currentBackgroundVersion = texture.version;\n        currentTonemapping = renderer.toneMapping;\n      } // push to the pre-sorted opaque render list\n\n\n      renderList.unshift(boxMesh, boxMesh.geometry, boxMesh.material, 0, 0, null);\n    } else if (background && background.isTexture) {\n      if (planeMesh === undefined) {\n        planeMesh = new Mesh(new PlaneBufferGeometry(2, 2), new ShaderMaterial({\n          type: 'BackgroundMaterial',\n          uniforms: cloneUniforms(ShaderLib.background.uniforms),\n          vertexShader: ShaderLib.background.vertexShader,\n          fragmentShader: ShaderLib.background.fragmentShader,\n          side: FrontSide,\n          depthTest: false,\n          depthWrite: false,\n          fog: false\n        }));\n        planeMesh.geometry.deleteAttribute('normal'); // enable code injection for non-built-in material\n\n        Object.defineProperty(planeMesh.material, 'map', {\n          get: function () {\n            return this.uniforms.t2D.value;\n          }\n        });\n        objects.update(planeMesh);\n      }\n\n      planeMesh.material.uniforms.t2D.value = background;\n\n      if (background.matrixAutoUpdate === true) {\n        background.updateMatrix();\n      }\n\n      planeMesh.material.uniforms.uvTransform.value.copy(background.matrix);\n\n      if (currentBackground !== background || currentBackgroundVersion !== background.version || currentTonemapping !== renderer.toneMapping) {\n        planeMesh.material.needsUpdate = true;\n        currentBackground = background;\n        currentBackgroundVersion = background.version;\n        currentTonemapping = renderer.toneMapping;\n      } // push to the pre-sorted opaque render list\n\n\n      renderList.unshift(planeMesh, planeMesh.geometry, planeMesh.material, 0, 0, null);\n    }\n  }\n\n  function setClear(color, alpha) {\n    state.buffers.color.setClear(color.r, color.g, color.b, alpha, premultipliedAlpha);\n  }\n\n  return {\n    getClearColor: function () {\n      return clearColor;\n    },\n    setClearColor: function (color, alpha) {\n      clearColor.set(color);\n      clearAlpha = alpha !== undefined ? alpha : 1;\n      setClear(clearColor, clearAlpha);\n    },\n    getClearAlpha: function () {\n      return clearAlpha;\n    },\n    setClearAlpha: function (alpha) {\n      clearAlpha = alpha;\n      setClear(clearColor, clearAlpha);\n    },\n    render: render\n  };\n}\n\nexport { WebGLBackground };","map":{"version":3,"sources":["D:/chrlab/src/component/panelComponent/Canvas/threejs/src/renderers/webgl/WebGLBackground.js"],"names":["BackSide","FrontSide","CubeUVReflectionMapping","BoxBufferGeometry","PlaneBufferGeometry","ShaderMaterial","Color","Mesh","ShaderLib","cloneUniforms","WebGLBackground","renderer","state","objects","premultipliedAlpha","clearColor","clearAlpha","planeMesh","boxMesh","currentBackground","currentBackgroundVersion","currentTonemapping","render","renderList","scene","camera","forceClear","background","xr","session","getSession","environmentBlendMode","setClear","isColor","autoClear","clear","autoClearColor","autoClearDepth","autoClearStencil","isCubeTexture","isWebGLCubeRenderTarget","mapping","undefined","type","uniforms","cube","vertexShader","fragmentShader","side","depthTest","depthWrite","fog","geometry","deleteAttribute","onBeforeRender","matrixWorld","copyPosition","Object","defineProperty","material","get","envMap","value","update","texture","flipEnvMap","version","toneMapping","needsUpdate","unshift","isTexture","t2D","matrixAutoUpdate","updateMatrix","uvTransform","copy","matrix","color","alpha","buffers","r","g","b","getClearColor","setClearColor","set","getClearAlpha","setClearAlpha"],"mappings":"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","sourcesContent":["/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nimport { BackSide, FrontSide, CubeUVReflectionMapping } from '../../constants.js';\nimport { BoxBufferGeometry } from '../../geometries/BoxGeometry.js';\nimport { PlaneBufferGeometry } from '../../geometries/PlaneGeometry.js';\nimport { ShaderMaterial } from '../../materials/ShaderMaterial.js';\nimport { Color } from '../../math/Color.js';\nimport { Mesh } from '../../objects/Mesh.js';\nimport { ShaderLib } from '../shaders/ShaderLib.js';\nimport { cloneUniforms } from '../shaders/UniformsUtils.js';\n\nfunction WebGLBackground( renderer, state, objects, premultipliedAlpha ) {\n\n\tvar clearColor = new Color( 0x000000 );\n\tvar clearAlpha = 0;\n\n\tvar planeMesh;\n\tvar boxMesh;\n\n\tvar currentBackground = null;\n\tvar currentBackgroundVersion = 0;\n\tvar currentTonemapping = null;\n\n\tfunction render( renderList, scene, camera, forceClear ) {\n\n\t\tvar background = scene.background;\n\n\t\t// Ignore background in AR\n\t\t// TODO: Reconsider this.\n\n\t\tvar xr = renderer.xr;\n\t\tvar session = xr.getSession && xr.getSession();\n\n\t\tif ( session && session.environmentBlendMode === 'additive' ) {\n\n\t\t\tbackground = null;\n\n\t\t}\n\n\t\tif ( background === null ) {\n\n\t\t\tsetClear( clearColor, clearAlpha );\n\n\t\t} else if ( background && background.isColor ) {\n\n\t\t\tsetClear( background, 1 );\n\t\t\tforceClear = true;\n\n\t\t}\n\n\t\tif ( renderer.autoClear || forceClear ) {\n\n\t\t\trenderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\n\n\t\t}\n\n\t\tif ( background && ( background.isCubeTexture || background.isWebGLCubeRenderTarget || background.mapping === CubeUVReflectionMapping ) ) {\n\n\t\t\tif ( boxMesh === undefined ) {\n\n\t\t\t\tboxMesh = new Mesh(\n\t\t\t\t\tnew BoxBufferGeometry( 1, 1, 1 ),\n\t\t\t\t\tnew ShaderMaterial( {\n\t\t\t\t\t\ttype: 'BackgroundCubeMaterial',\n\t\t\t\t\t\tuniforms: cloneUniforms( ShaderLib.cube.uniforms ),\n\t\t\t\t\t\tvertexShader: ShaderLib.cube.vertexShader,\n\t\t\t\t\t\tfragmentShader: ShaderLib.cube.fragmentShader,\n\t\t\t\t\t\tside: BackSide,\n\t\t\t\t\t\tdepthTest: false,\n\t\t\t\t\t\tdepthWrite: false,\n\t\t\t\t\t\tfog: false\n\t\t\t\t\t} )\n\t\t\t\t);\n\n\t\t\t\tboxMesh.geometry.deleteAttribute( 'normal' );\n\t\t\t\tboxMesh.geometry.deleteAttribute( 'uv' );\n\n\t\t\t\tboxMesh.onBeforeRender = function ( renderer, scene, camera ) {\n\n\t\t\t\t\tthis.matrixWorld.copyPosition( camera.matrixWorld );\n\n\t\t\t\t};\n\n\t\t\t\t// enable code injection for non-built-in material\n\t\t\t\tObject.defineProperty( boxMesh.material, 'envMap', {\n\n\t\t\t\t\tget: function () {\n\n\t\t\t\t\t\treturn this.uniforms.envMap.value;\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\tobjects.update( boxMesh );\n\n\t\t\t}\n\n\t\t\tvar texture = background.isWebGLCubeRenderTarget ? background.texture : background;\n\n\t\t\tboxMesh.material.uniforms.envMap.value = texture;\n\t\t\tboxMesh.material.uniforms.flipEnvMap.value = texture.isCubeTexture ? - 1 : 1;\n\n\t\t\tif ( currentBackground !== background ||\n\t\t\t\tcurrentBackgroundVersion !== texture.version ||\n\t\t\t\tcurrentTonemapping !== renderer.toneMapping ) {\n\n\t\t\t\tboxMesh.material.needsUpdate = true;\n\n\t\t\t\tcurrentBackground = background;\n\t\t\t\tcurrentBackgroundVersion = texture.version;\n\t\t\t\tcurrentTonemapping = renderer.toneMapping;\n\n\t\t\t}\n\n\t\t\t// push to the pre-sorted opaque render list\n\t\t\trenderList.unshift( boxMesh, boxMesh.geometry, boxMesh.material, 0, 0, null );\n\n\t\t} else if ( background && background.isTexture ) {\n\n\t\t\tif ( planeMesh === undefined ) {\n\n\t\t\t\tplaneMesh = new Mesh(\n\t\t\t\t\tnew PlaneBufferGeometry( 2, 2 ),\n\t\t\t\t\tnew ShaderMaterial( {\n\t\t\t\t\t\ttype: 'BackgroundMaterial',\n\t\t\t\t\t\tuniforms: cloneUniforms( ShaderLib.background.uniforms ),\n\t\t\t\t\t\tvertexShader: ShaderLib.background.vertexShader,\n\t\t\t\t\t\tfragmentShader: ShaderLib.background.fragmentShader,\n\t\t\t\t\t\tside: FrontSide,\n\t\t\t\t\t\tdepthTest: false,\n\t\t\t\t\t\tdepthWrite: false,\n\t\t\t\t\t\tfog: false\n\t\t\t\t\t} )\n\t\t\t\t);\n\n\t\t\t\tplaneMesh.geometry.deleteAttribute( 'normal' );\n\n\t\t\t\t// enable code injection for non-built-in material\n\t\t\t\tObject.defineProperty( planeMesh.material, 'map', {\n\n\t\t\t\t\tget: function () {\n\n\t\t\t\t\t\treturn this.uniforms.t2D.value;\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\tobjects.update( planeMesh );\n\n\t\t\t}\n\n\t\t\tplaneMesh.material.uniforms.t2D.value = background;\n\n\t\t\tif ( background.matrixAutoUpdate === true ) {\n\n\t\t\t\tbackground.updateMatrix();\n\n\t\t\t}\n\n\t\t\tplaneMesh.material.uniforms.uvTransform.value.copy( background.matrix );\n\n\t\t\tif ( currentBackground !== background ||\n\t\t\t\tcurrentBackgroundVersion !== background.version ||\n\t\t\t\tcurrentTonemapping !== renderer.toneMapping ) {\n\n\t\t\t\tplaneMesh.material.needsUpdate = true;\n\n\t\t\t\tcurrentBackground = background;\n\t\t\t\tcurrentBackgroundVersion = background.version;\n\t\t\t\tcurrentTonemapping = renderer.toneMapping;\n\n\t\t\t}\n\n\n\t\t\t// push to the pre-sorted opaque render list\n\t\t\trenderList.unshift( planeMesh, planeMesh.geometry, planeMesh.material, 0, 0, null );\n\n\t\t}\n\n\t}\n\n\tfunction setClear( color, alpha ) {\n\n\t\tstate.buffers.color.setClear( color.r, color.g, color.b, alpha, premultipliedAlpha );\n\n\t}\n\n\treturn {\n\n\t\tgetClearColor: function () {\n\n\t\t\treturn clearColor;\n\n\t\t},\n\t\tsetClearColor: function ( color, alpha ) {\n\n\t\t\tclearColor.set( color );\n\t\t\tclearAlpha = alpha !== undefined ? alpha : 1;\n\t\t\tsetClear( clearColor, clearAlpha );\n\n\t\t},\n\t\tgetClearAlpha: function () {\n\n\t\t\treturn clearAlpha;\n\n\t\t},\n\t\tsetClearAlpha: function ( alpha ) {\n\n\t\t\tclearAlpha = alpha;\n\t\t\tsetClear( clearColor, clearAlpha );\n\n\t\t},\n\t\trender: render\n\n\t};\n\n}\n\n\nexport { WebGLBackground };\n"]},"metadata":{},"sourceType":"module"}